dist: focal
language: c
git:
  depth: false
before_install:
- sudo apt-get update
- sudo apt-get -y install gcc-arm-none-eabi libnewlib-arm-none-eabi libnewlib-nano-arm-none-eabi
- sudo python3 -m pip install scons
before_script:
- git clone https://github.com/eerimoq/cantools.git
- cd cantools
- git checkout f42efa9bf8a9b6c7723d75df8f92a41f20f9c756
- sudo python setup.py install
- cd ..
script:
- scons -C firmware build-opencm3 -j2
- build-wrapper-linux-x86-64 --out-dir bw-output scons -C firmware build -j2
- sonar-scanner
notifications:
  email:
  - andreas.dahlberg90@gmail.com
addons:
  sonarcloud:
    organization: "andreasdahlberg-github"
    token: $SONAR_TOKEN
