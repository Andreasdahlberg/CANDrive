name: CANDrive CI
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - name: Install cantools
        run: |
          git clone https://github.com/eerimoq/cantools.git
          cd cantools
          git checkout f42efa9bf8a9b6c7723d75df8f92a41f20f9c756
          pip install --user -e .
          cd ..
      - name: Install build tools
        run: sudo apt install -y gcc-arm-none-eabi libnewlib-arm-none-eabi libnewlib-nano-arm-none-eabi
      - name: Install SCons
        run: sudo python3 -m pip install scons

      - name: Check out repository and submodules
        uses: actions/checkout@v2
        with:
          submodules: recursive

      - name: Build LibOpenCM3
        run: |
          scons -C ${{ github.workspace }}/firmware build-opencm3 -j2
